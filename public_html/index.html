<!DOCTYPE html>
<html lang="en-gb">
    <head>
		<title>Hive-Sense Demo</title>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon" />
		<link href="css/bootstrap_blr.css" rel="stylesheet" media="screen" />
		<link href="css/main.css" rel="stylesheet" media="screen" />
		<style id="dynamic-style">

		</style>
		<link href="css/bootstrap-responsive.css" rel="stylesheet" media="screen" />
    </head>
    <body>

		<div class="navbar navbar-static-top">
			<div class="navbar-inner">
				<div class="container">
					<button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="brand" title="Reload application" href="./">HiveSense</a>
					<div class="nav-collapse collapse">
						<ul class="nav">
							<li id="li-home" class="active"><a href="#">Home</a></li>
							<li id="li-graphs"><a href="#">Graphs</a></li>
							<li id="li-history"><a href="#">History</a></li>
							<li id="li-about"><a href="#">About</a></li>
							<li id="li-settings"><a href="#" style="padding:0;">
									<img src="img/gear2.png" width="40" height="40" alt="settings" title="Change Application Settings" class="menu-img" />
								</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div id="settings" class="container hiddenTab">
			<h1 id="top0">Application Settings</h1>
			<div class="row">

				<div class="span8">

					<h3>Alarms</h3>

					<div style="margin-bottom: 1em;">
						<span>
							<button id='settings-alarm-add' class="btn btn-info">Add</button>
							<button id="settings-alarm-modify" class="btn btn-warning">Modify</button>
							<select id="settings-alarm-choose">
								<option>Disturbance</option>
								<option>Too Cold</option>
								<option>Too Hot</option>
								<option>Excess Light</option>
							</select>
						</span>
					</div>

					<div class="form-horizontal left settingBlock">
						<div class="control-group">
							<label class="control-label" for="settings-alarm-label">Label</label>
							<div class="controls">
								<input type="text" id="settings-alarm-label" placeholder="Label">
							</div>
						</div>
						<div class="control-group">
							<label class="control-label" for="settings-alarm-sensor">Sensor</label>
							<div class="controls">
								<select id="settings-alarm-sensor">
									<option>Temp-in</option>
									<option>Humidity</option>
									<option>Light</option>
									<option>Motion</option>
								</select>
							</div>
						</div>
						<div class="control-group">
							<label class="control-label" for="settings-alarm-threshold-value">Threshold</label>
							<div id="settings-alarm-threshold" class="controls">
								<select class="input-medium">
									<option selected>Above</option>
									<option>Below</option>
								</select>
								<input class="input-mini" type="text" id="settings-alarm-threshold-value" />
								<span>Kg</span>
							</div>
						</div>
						<div class="control-group">
							<label class="control-label" for="settings-alarm-email">Max frequency of alerts</label>
							<div class="controls">
								<input type="text" id="settings-alarm-email" class="input-mini" />
								<span>hrs</span>
							</div>
						</div>

						<button id="settings-alarm-save" class="btn btn-primary">Save Alarm</button>
						<button id="settings-alarm-delete" class="btn btn-danger">Delete Alarm</button>
					</div>

					<h4>Local Weather Source</h4>
					Enter name of any city or major town in the UK<br />
					<div class="input-append">
						<input id="wxPlace" type="text" placeholder="Name of City" />
						<button id="settings-wx-save" class="btn btn-primary">Save</button>
					</div>

					<h4>General</h4>
					<div class="form-horizontal left settingBlock">
						<div class="control-group">
							<label class="control-label" for="settings-general-email">Email address</label>
							<div class="controls">
								<input type="email" id="settings-general-email" placeholder="Your email">
							</div>
						</div>

						<div class="control-group">
							<label class="control-label" for="settings-general-hive">Hive name</label>
							<div class="controls">
								<input type="email" id="settings-general-hive" placeholder="Beehive name">
							</div>
						</div>
						<button id="settings-general-save" class="btn btn-primary">Save</button>
					</div>

				</div>

				<div class="span4">
					<div class="sidebar">
						<h4>Saving</h4>
						<p>All changes made on the left only take effect locally. However, these settings can be
						made permanently to the server using the 'Commit' button here (password required).</p>
						<div class="input-append">
							<input id='settings-password' class='input-small' type='password' placeholder="Password" />
							<button id="settings-save2" type="button" class="btn btn-success">Commit</button>
						</div>
						<span id="settings-saved" class="label label-success hiddenTab padded-light">Success</span>
						<span id="settings-notsaved" class="label label-important hiddenTab padded-light">Bad password</span>
					</div>
				</div>
			</div>
		</div>

		<div id="home" class="container">
			<h1 id="top">Live Feed from <span id="hive-name">Hive</span></h1>

			<div class="row">
				<div class="span3">
					<h3>Alarms</h3>
					<table class="table-hover">
						<tbody id="alarms">
							<!-- Permanent Alarms -->
							<tr data-toggle="tooltip" title="Hive movement detected in the past hour">
								<td><img id="alarm-motion" src="img/LED_Blue.png" alt="" /></td>
								<td>Disturbance</td>
							</tr>
							<!-- END Permanent Alarms -->
						</tbody>
					</table>

					<h3>Local Weather</h3>
					<div class="subtle"><span id="weather-place">Loading...</span>, <span id="weather-time"></span></div>
					<span id="weather-weather"></span>

					<div>
						<h3>Unit Selection</h3>
						<label class="radio">
							<input type="radio" name="units" id="unit_EU" value="EU" checked />
							Metric
						</label>
						<label class="radio">
							<input type="radio" name="units" id="unit_US" value="US" />
							Imperial
						</label>
					</div>
				</div>
				<!-- Permanent Sensors -->
				<div class="span9">
					<div data-toggle="tooltip" title="Last update from hive" class="high-line">
						<span id="updated-led" class="badge badge-success">&nbsp;</span>
						<span id="updated-date">DDDD dds MMMM, HH:mm zzz</span>
						<span class="subtle">&nbsp; <span id="updated-ago" >x tttt</span> ago</span>
					</div>
					<div class="row-fluid">
						<div class="span6">
							<div class="row-fluid">
								<div class="span12 sensor sensor-temperature">
									<div class="span4 bg-sensor bg-temperature" data-toggle="tooltip" title="Temperature in and out the hive">
										&nbsp;
									</div>
									<div class="span8 text-center">
										<div class="high-line subtle">
											<span id="sensor-value-temp1" class="sensor-value-text">xx.x C</span> in
											<span id="sensor-trend-temp1" class="arrow-none trend-arrow">&#x25ac;</span>
										</div>
										<div class="high-line subtle">
											<span id="sensor-value-temp2" class="sensor-value-text">xx.x C</span> out
											<span id="sensor-trend-temp2" class="arrow-none trend-arrow">&#x25ac;</span>
										</div>
										<div class="high-line subtle">
											<span id="sensor-value-tempdiff" class="sensor-value-text">+x.x C</span> diff
											<span id="sensor-trend-tempdiff" class="arrow-none trend-arrow">&#x25ac;</span>
										</div>
									</div>
								</div>
							</div>

						</div>
						<div id="sensor-graph-temp" class="span6 sensor-graph-large"></div>
					</div>

					<div id="sensors">
						<!-- PLaceholder for custom sensors (dynamically loaded) -->
					</div>

					<div class="row-fluid" style="padding-top: 1em;">
						<div class="span6">
							<div class="row-fluid">
								<div class="span12 sensor sensor-motion">
									<div class="span5 bg-sensor bg-hive" data-toggle="tooltip" title="External hive disturbance indicator">
										&nbsp;
									</div>
									<div class="span7 text-center text-sensor">
										<span id="sensor-value-motion" class="motion-no sensor-value-text">Stationary</span>
										<br />
										<span id="sensor-trend-motion" class="subtle">Last motion HH:mm, DDDD</span>
									</div>
								</div>
							</div>
							<div id="sensor-graph-motion" class="span12 sensor-graph-small"></div>

						</div>
						<div class="span6" data-toggle="tooltip" title="Hivecam (imagine you're looking at bees)">
							<img id="camera" class="img-rounded img-responsive" src="img/bee3.png" alt="hive pic" />
						</div>
					</div>
					<!-- END Permanent Sensors -->

				</div>

			</div>
		</div>

		<div class="hiddenTab container" id="about">
			<h1 id="top2">About HiveSense</h1>
			<div class="row">
				<div class="span2">
					<h4>Useful Links</h4>
					<ul class="unstyled">
						<li><a href="https://github.com/blrnw3/hivesenseNodejs">Codebase on Github</a></li>
						<li><a href="http://hivesense.wordpress.com/">Hivesense blog</a></li>
					</ul>
				</div>
				<div class="span10">
					<h2>Outline</h2>
					Bee-friendly monitoring systems.<br />
					Coming soon to a hive near you.

					<h2>Project Specification</h2>
					Hivesense is a project to enrich the process of monitoring beehives, using off-the-shelf hardware
					and free, open-source software. This web application, along with the device that produces the data feed, have been developed
					as part of a Masters' project at UCL running between June and August 2013. The blog linked on the left
					gives more details. The main aim of this project is to develop a customisable software stack that can be easily implemented by
					beekeepers across the land, and furthered by future projects. I welcome feedback and suggestions of any nature (see email in the footer).

					<h3>Details</h3>

					<h4>Hardware</h4>
					Variety of sensors to measure environmental properties, a camera, and a motion detector (alert when hive knocked-over).<br />
					Full parts List
					<ul>
						<li>GHI FEZ mainboard with power and Wi-Fi modules, plus temperature/humidity, accelerometer, barometer/temperature, and light sensors
							(<a href="https://www.ghielectronics.com/catalog/category/265">Source</a>)</li>
						<li>SD card for loading configuration (Wi-Fi settings, server URL etc.)</li>
						<li>Power supply (anything in range 5-30V)</li>
						<li>Mounting kit - <a href="http://proto-pic.co.uk/tamiya-70157-universal-plate-set-2pcs/">prototyping plate</a> plus assorted ironmongery</li>
						<li>Other Gadgeteer sensors - <a href="http://gadgeteering.net/hardware">as desired</a>.</li>
					</ul>
					Total cost: ~Â£200<br />
					Installation time: ~1hr.
					<div>
						<img src="img/DeviceVF.jpg" alt="Device" class="img-responsive" />
						<p class="caption">Monitoring device which produces the data. Dimensions: 16 x 12 cm</p>
					</div>

					<h4>Software</h4>
					Gadgeteer SDK, pushed to Node.js server hosted on Azure, sensor data stored in Azure Tables database, JS front-end
					 (all on GitHub, along with all dependencies, so web part is directly deployable to any Node 0.8+ compatible environment). <br />
					Requirements: Windows Azure account.


					<h2>Credits</h2>
					<ul class="unstyled">
						<li>Graphs built with <a href="https://github.com/flot/flot">flot</a></li>
						<li>Hardware (<a href="http://www.netmf.com/gadgeteer/">Gadgeteer</a>) from Microsoft</li>
						<li>Some CSS and JS from <a href="https://github.com/twitter/bootstrap/">Bootstrap</a> was used to aid UI design, and improve UX</li>
						<li>Weather API from <a href="http://www.wunderground.com/weather/api/">Wunderground</a></li>
						<li>All static images are from <a href="http://openclipart.org/">Open ClipArt</a> so are <a href="http://creativecommons.org/about/cc0">public domain</a></li>
						<li>Various Node and client JS libraries - see the <a href="https://github.com/blrnw3/hivesenseNodejs">code listing</a> for full details</li>
						<li>Web server/application and database hosting by <a href='http://www.windowsazure.com/en-us/'>Windows Azure</a></li>
						<li>General and financial support from UCL and Microsoft (supervised by Steven Johnston).</li>
					</ul>

					<h3>Warning</h3>
					Some plots may be empty due to the intermittent nature of test data.<br />
					This web application may change drastically at any time, and without prior notice.
				</div>
			</div>
		</div>
		<div class="hiddenTab container" id="history">
			<h1 id="top3">Historical Hive Data</h1>
			<div class="row">
				<div class="span6">
					<h3>API</h3>
					<p>Data can be obtained in CSV, XML, or JSON format directly from the
					Hivesense API using the base URL<br />
					http://hivesensenodejs.azurewebsites.net/feed <br />
					and appending to this URL one of the following:
					</p>

					<h5>Current Data</h5>
					?current <br />
					e.g. <a href='http://hivesensenodejs.azurewebsites.net/feed?current'>.../feed?current</a>

					<h5>Current Hivecam</h5>
					?hivecam <br />
					i.e. <a href='http://hivesensenodejs.azurewebsites.net/feed?hivecam'>.../feed?hivecam</a>

					<h5>Recent Data</h5>
					?recent=[options]<br />
					options: number followed by period-type: h,d or m (hours, days, months)<br />
					e.g. <a href='http://hivesensenodejs.azurewebsites.net/feed?recent=0.8h'>.../feed?recent=0.8h</a>
					<br />In the response, timestamps are UTC and in millisecond
					<a href="http://en.wikipedia.org/wiki/Unix_time"> Unix time </a>.
					<h5>Format</h5>
					Add &amp;format=[json,xml,csv] to either current or recent data (default is json)<br />
					e.g. <a href='http://hivesensenodejs.azurewebsites.net/feed?recent=2d&amp;format=csv'>.../feed?recent=2d&amp;format=csv</a>

					<h4>Inputting data</h4>
					<p>This should be handled by the monitoring device itself, but these docs provide usage for manual testing, which can be useful. <br />
						Security: Only users with a valid "X-HiveSenseSecureKey" header will be successfully authenticated
						(receiving a 200 response), others will be rejected with a 401 Unauthorised. <br />
						Notes: Results are never cached, and PUT/POST are currently handled in the same way.<br />
						Sample usage:
					</p>
					<h6>Single Datapoint</h6>
					URL: /posty<br />
					Data format: JSON<br />
					<pre>
{
  "datapoints": [
    {
      "channels": {
        "temp": "34.6",
        "humi": "54",
        "light": "0",
        "key": "value"
      }
    }
  ]
}
					</pre>
					<h6>Multiple Datapoints</h6>
					URL: /posty<br />
					Data format: JSON<br />
					e.g.
					<pre>
{
  "datapoints": [
    {
      "channels": {
        "temp": "37.2",
        "humi": "52",
        "light": "0",
        "key": "value"
      },
      "datetime": "2013-07-21T12:00:02Z"
    },
    {
      "channels": {
        "temp": "35.2",
        "humi": "42",
        "light": "5",
        "key": "value"
      },
      "datetime": "Javascript-compatible dateString"
    }
  ]
}
					</pre>

					<h6>Image</h6>
					URL: /posty?image<br />
					Data format: binary<br />
					e.g.
					<pre>
0000AF0204E0C0B2B6B9D9E9EC944829D39A
					</pre>

				</div>
				<div class="span6">
					<h3>Tables</h3>
					Sortable, aggregateable tables coming soon. Maybe.
				</div>
			</div>
		</div>
		<div class="hiddenTab container" id="graphs">
			<h1 id="top4">Recent Graphs</h1>
			<div class="row">
				<div class="span2">
					<div id="graphs-options-variables">
						<h5>Variables</h5>
					</div>
					<div id="graphs-options-periods">
						<h5>Period</h5>
						<label class="radio"><input type="radio" name="period" value="now" />3 hrs</label>
						<label class="radio"><input type="radio" name="period" value="day" checked />Day</label>
						<label class="radio"><input type="radio" name="period" value="week" checked />Week</label>
						<label class="radio"><input type="radio" name="period" value="month" />Month</label>
					</div>
				</div>
				<div class="span10">
					<div id="sensor-graph-main"></div>
				</div>
			</div>
		</div>


		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span12 footer">
					<div>HiveSense v0.3</div>
					<div>&copy; 2013 Ben Lee-Rodgers, UCL, London</div>
					<div><a href="#top">Top</a> | Contact: b.lee-rodgers.12 [at] ucl.ac.uk</div>
					<div>Caution: Site is under development; data may be faked for testing purposes</div>
				</div>
			</div>
		</div>

		<!-- External or imported Libraries for utility, graphing and UI/UX purposes -->
		<script src="http://code.jquery.com/jquery.js"></script>
		<script src="js/libs/bootstrap.min.js"></script>
		<script src="js/libs/jquery.dateFormat-1.0.js"></script> <!-- Source: https://github.com/phstc/jquery-dateFormat -->
		<script src="js/libs/flotGraphs/jquery.flot.js"></script>
		<script src="js/libs/flotGraphs/jquery.flot.time.js"></script>
		<script src="js/libs/flotGraphs/jquery.flot.resize.js"></script>

		<!-- Homemade scripts for this project -->
		<script src="js/util.js"></script>
		<script src="js/Model.js"></script>
		<script src="js/graphs.js"></script>
		<script src="js/View.js"></script>
		<script src="js/Controller.js"></script>
		<script src="js/main.js"></script>

    </body>
</html>